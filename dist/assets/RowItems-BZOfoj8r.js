import{r as s,j as t}from"./react-Dzin6bBt.js";import{u as A,f as v,c as M,g as E,a as H}from"./@tanstack-CWJAimbQ.js";import{u as I,a as y}from"./index-BRKcmzoU.js";import"./select-DYJvg2A2.js";import{L as u}from"./react-router-dom-BJiSrDzD.js";import{B as S}from"./button-DEuGr3my.js";import{C as B}from"./card-BeAkOnfC.js";import{L as F}from"./Loader-BO7wm5pM.js";import{T as O,a as Q,b as T,c as J,d as P,e as _}from"./table-BhLnQFn3.js";import{A as q}from"./AlertDialogDemo-CtL3iQTm.js";import{I as z}from"./input-DNM5Pwah.js";import{c as G}from"./react-router-CsBO2-kY.js";import"./exenv-BTN8Bl8p.js";import"./react-dom-vuVZB_ht.js";import"./scheduler-CzFDRTuY.js";import"./axios-CCb-kr4I.js";import"./@radix-ui-BiFA3u8r.js";import"./aria-hidden-DQ5UC2Eg.js";import"./react-remove-scroll-Bffst3Sv.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-C0y-sxxv.js";import"./react-style-singleton-CNUZfl4K.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-BgPSE0Zt.js";import"./use-callback-ref-CM22xisT.js";import"./@floating-ui-B50KHoMa.js";import"./clsx-B-dksMZM.js";import"./tailwind-merge-Dnoi3Axr.js";import"./lucide-react-DVh0U7qo.js";import"./@remix-run-CDTKzl14.js";import"./class-variance-authority-Bb4qSo10.js";function Te(){const{user:r,setNotification:p}=I(),n=G(),[x,R]=s.useState([]),[c,K]=s.useState("all"),[D,d]=s.useState(!1),[h,f]=s.useState(null),[L,m]=s.useState(!1),[i,g]=s.useState("");s.useEffect(()=>{["owner","admin","cdmiadmin","cdmi","visiter"].includes(r.role)||n("/404")},[r,n]);const w=()=>{d(!0),y.get(`/rows${c!=="all"?`?category=${c}`:""}`).then(o=>{R(o.data),d(!1)}).catch(o=>{console.error("Error fetching todos",o),d(!1)})};s.useEffect(()=>{w()},[c]);const j=o=>{f(o),m(!0)},V=()=>{h&&y.delete(`/row/${h.id}`).then(()=>{p("row was successfully deleted"),w()}).catch(o=>{console.log(o),p("Error deleting todo",o)}),m(!1),f(null)},l=M(),k=s.useMemo(()=>{const o=[l.accessor("title",{header:"Title",cell:e=>e.getValue()}),l.accessor("description",{header:"Description",cell:e=>e.getValue()?e.getValue().length>25?`${e.getValue().substring(0,25)}...`:e.getValue():" "}),l.accessor("files",{header:"Files",cell:e=>{const a=JSON.parse(e.getValue()||"[]");return a.length>0?a.map(($,N)=>t.jsxs(u,{to:`https://my.thedhruvish.com/api/storage/${$}`,className:"text-blue-500 hover:underline",target:"_blank",children:["View File ",N+1]},N)):"No files"}}),l.display({id:"actions",header:"Actions",cell:({row:e})=>r.role==="owner"||r.role==="admin"?t.jsxs(t.Fragment,{children:[t.jsx(u,{to:`/row/${e.original.id}`,className:"text-blue-500 hover:underline",children:"Show"}),t.jsx(S,{className:"ml-4 hover:bg-red-600",onClick:()=>j(e.original),children:"Delete"})]}):t.jsx(u,{to:`/row/${e.original.id}`,className:"text-blue-500 hover:underline",children:"Show"})})];return(r.role==="owner"||r.role==="admin")&&o.push(l.accessor("author",{header:"Author",cell:e=>e.getValue()})),o},[r,j]),C=s.useMemo(()=>(x||[]).filter(o=>{var e,a;return(((e=o.title)==null?void 0:e.toLowerCase())||"").includes(i.toLowerCase())||(((a=o.description)==null?void 0:a.toLowerCase())||"").includes(i.toLowerCase())}),[x,i]),b=A({data:C,columns:k,getCoreRowModel:E(),getSortedRowModel:H()});return t.jsxs("div",{className:"p-4 mx-auto",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4",children:[t.jsx("h1",{className:"text-2xl font-semibold cursor-pointer",onClick:()=>g(""),children:"Row Items"}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center w-full sm:w-auto sm:space-x-4",children:[t.jsx(z,{type:"text",placeholder:"Search",value:i,onChange:o=>g(o.target.value),className:"py-2 px-4 rounded-md focus:outline-none focus:ring-2 sm:order-2 xl:w-[200px]"}),t.jsx(S,{className:"bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 sm:order-2 xl:w-[100px]",onClick:()=>n("/row/new"),children:"Create"})]})]}),t.jsxs("div",{className:"mt-8",children:[t.jsx(B,{className:"overflow-x-auto",children:D?t.jsx("div",{className:"flex items-center justify-center p-4",children:t.jsx(F,{})}):C.length>0?t.jsxs(O,{children:[t.jsx(Q,{children:b.getHeaderGroups().map(o=>t.jsx(T,{children:o.headers.map(e=>t.jsx(J,{className:"cursor-pointer",children:e.isPlaceholder?null:t.jsxs("div",{onClick:e.column.getToggleSortingHandler(),children:[v(e.column.columnDef.header,e.getContext()),{asc:" ðŸ”¼ ",desc:" ðŸ”½ "}[e.column.getIsSorted()]??null]})},e.id))},o.id))}),t.jsx(P,{children:b.getRowModel().rows.map(o=>t.jsx(T,{children:o.getVisibleCells().map(e=>t.jsx(_,{children:v(e.column.columnDef.cell,e.getContext())},e.id))},o.id))})]}):t.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"No rows found."})}),t.jsx(q,{open:L,onClose:()=>m(!1),onConfirm:V,title:"Confirm Deletion",description:"Are you sure you want to delete this todo? This action cannot be undone."})]})]})}export{Te as default};
