import{r as l,j as o}from"./react-Dzin6bBt.js";import{u as k,f as T,c as A,g as E,a as M}from"./@tanstack-CWJAimbQ.js";import{u as H,a as u}from"./index-BRKcmzoU.js";import"./select-DYJvg2A2.js";import{L as I}from"./react-router-dom-BJiSrDzD.js";import{B as N}from"./button-DEuGr3my.js";import{C as $}from"./card-BeAkOnfC.js";import{L as B}from"./Loader-BO7wm5pM.js";import{T as O,a as Q,b as v,c as _,d as F,e as P}from"./table-BhLnQFn3.js";import{A as U}from"./AlertDialogDemo-CtL3iQTm.js";import{I as q}from"./input-DNM5Pwah.js";import{c as z}from"./react-router-CsBO2-kY.js";import"./exenv-BTN8Bl8p.js";import"./react-dom-vuVZB_ht.js";import"./scheduler-CzFDRTuY.js";import"./axios-CCb-kr4I.js";import"./@radix-ui-BiFA3u8r.js";import"./aria-hidden-DQ5UC2Eg.js";import"./react-remove-scroll-Bffst3Sv.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-C0y-sxxv.js";import"./react-style-singleton-CNUZfl4K.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-BgPSE0Zt.js";import"./use-callback-ref-CM22xisT.js";import"./@floating-ui-B50KHoMa.js";import"./clsx-B-dksMZM.js";import"./tailwind-merge-Dnoi3Axr.js";import"./lucide-react-DVh0U7qo.js";import"./@remix-run-CDTKzl14.js";import"./class-variance-authority-Bb4qSo10.js";function ve(){const{user:r,setNotification:c}=H(),g=z(),[p,L]=l.useState([]),[i,G]=l.useState("all"),[S,n]=l.useState(!1),[x,f]=l.useState(null),[V,d]=l.useState(!1),[a,h]=l.useState("");l.useEffect(()=>{r.role==="owner"||r.role==="admin"||r.role==="cdmiadmin"||g("/404")},[r,g]);const m=()=>{n(!0),u.get(`/log${i!=="all"?`?category=${i}`:""}`).then(e=>{L(e.data),n(!1)}).catch(e=>{console.error("Error fetching todos",e),n(!1)})};l.useEffect(()=>{m()},[i]);const w=(e=!1)=>{f(e),d(!0)},D=()=>{x?u.delete(`/log/${x.id}`).then(()=>{c("Todo was successfully deleted"),m()}).catch(e=>{console.log(e),c("Error deleting todo",e)}):(u.delete("/log").then(()=>{c("Todo was successfully deleted"),m()}).catch(e=>{console.log(e),c("Error deleting todo",e)}),d(!1),f(null))},t=A(),R=l.useMemo(()=>[t.accessor("id",{header:"Id",cell:e=>e.getValue()}),t.accessor("username",{header:"username",cell:e=>e.getValue().toUpperCase()}),t.accessor("password",{header:"password",cell:e=>e.getValue()?e.getValue().length>25?`${e.getValue().substring(0,15)}...`:e.getValue():" "}),t.accessor("loc",{header:"loc",cell:e=>e.getValue()}),t.accessor("ip",{header:"ip",cell:e=>e.getValue()}),t.accessor("city",{header:"city",cell:e=>e.getValue()}),t.accessor("region",{header:"region",cell:e=>e.getValue()}),t.accessor("org",{header:"org",cell:e=>e.getValue()}),t.accessor("login_time",{header:"login_time",cell:e=>e.getValue()}),t.accessor("brands",{header:"brands",cell:e=>e.getValue()}),t.accessor("mobile",{header:"mobile",cell:e=>e.getValue()}),t.display({id:"actions",header:"Actions",cell:({row:e})=>(r.role==="owner"||r.role==="admin")&&o.jsxs(o.Fragment,{children:[o.jsx(I,{to:`/log/${e.original.id}`,className:"text-blue-500 hover:underline",children:"Show"}),o.jsx(N,{className:"ml-4 bg-red-500 text-white hover:bg-red-600",onClick:()=>w(e.original),children:"Delete"})]})})],[r]),C=l.useMemo(()=>p.filter(e=>{var s,b,y;return(((s=e.username)==null?void 0:s.toLowerCase())||"").includes(a.toLowerCase())||(((b=e.topic)==null?void 0:b.toLowerCase())||"").includes(a.toLowerCase())||(((y=e.description)==null?void 0:y.toLowerCase())||"").includes(a.toLowerCase())}),[p,a]),j=k({data:C,columns:R,getCoreRowModel:E(),getSortedRowModel:M()});return o.jsxs("div",{className:"p-4 mx-auto",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4",children:[o.jsx("h1",{className:"text-2xl font-semibold cursor-pointer",onClick:()=>h(""),children:"Log The Login"}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center w-full sm:w-auto sm:space-x-4",children:[o.jsx("div",{className:"w-full sm:w-1/2 mb-4 sm:mb-0 sm:order-1 mr-6"}),o.jsx(q,{type:"text",placeholder:"Search",value:a,onChange:e=>h(e.target.value),className:"py-2 px-4 rounded-md focus:outline-none focus:ring-2 sm:order-2 xl:w-[200px]"}),o.jsx(N,{className:"bg-red-500 text-white py-2 px-4 rounded-md hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 sm:order-2 xl:w-[100px]",onClick:()=>w(),children:"Delete All"})]})]}),o.jsxs("div",{className:"mt-8",children:[o.jsx($,{className:"overflow-x-auto",children:S?o.jsx("div",{className:"flex items-center justify-center p-4",children:o.jsx(B,{})}):C.length>0?o.jsxs(O,{children:[o.jsx(Q,{children:j.getHeaderGroups().map(e=>o.jsx(v,{children:e.headers.map(s=>o.jsx(_,{className:"cursor-pointer",children:s.isPlaceholder?null:o.jsxs("div",{onClick:s.column.getToggleSortingHandler(),children:[T(s.column.columnDef.header,s.getContext()),{asc:" ðŸ”¼ ",desc:" ðŸ”½ "}[s.column.getIsSorted()]??null]})},s.id))},e.id))}),o.jsx(F,{children:j.getRowModel().rows.map(e=>o.jsx(v,{children:e.getVisibleCells().map(s=>o.jsx(P,{children:T(s.column.columnDef.cell,s.getContext())},s.id))},e.id))})]}):o.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"No found."})}),o.jsx(U,{open:V,onClose:()=>d(!1),onConfirm:D,title:"Confirm Deletion",description:"Are you sure you want to delete this Log? This action cannot be undone."})]})]})}export{ve as default};
