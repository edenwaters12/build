import{u as B,b as O,r as l,j as t,L as Q,a as L}from"./index-D2TPxXiu.js";import{u as F,f as E,c as U,g as q,a as z}from"./index-uVGQkMVq.js";import{S as G,a as J,b as K,c as i}from"./select-B3KVTSd3.js";import{B as D}from"./button-GmKsRPRy.js";import{C as W}from"./card-DQXNvk-Z.js";import{L as H}from"./Loader-2ymP49Ji.js";import{T as X,a as Y,b as V,c as Z,d as ee,e as te}from"./table-0Os8YReR.js";import{A as se}from"./AlertDialogDemo-CcE40q5i.js";import{I as le}from"./input-D2H9KHWJ.js";function xe(){const{user:a,setNotification:b}=B(),g=O(),[d,h]=l.useState([]),[r,M]=l.useState("all"),[c,f]=l.useState(!1),[v,S]=l.useState(null),[R,p]=l.useState(!1),[n,y]=l.useState(""),[k,j]=l.useState(1),[A,_]=l.useState(),[u,w]=l.useState(!0);l.useEffect(()=>{["owner","science"].some(e=>a.role.includes(e))||g("/404")},[a,g]);const C=()=>{!u||c||(f(!0),L.get(`/todos?page=${k}${r!=="all"?`&category=${r}`:""}`).then(e=>{h(s=>[...s,...e.data.data.filter(m=>!s.some(x=>x.id===m.id))]),_(e.data.total),e.data.current_page==e.data.last_page&&w(!1),j(s=>s+1),f(!1)}).catch(e=>{console.error("Error fetching todos",e),f(!1)}))};l.useEffect(()=>{C()},[r]),l.useEffect(()=>{const e=()=>{window.innerHeight+document.documentElement.scrollTop>=document.documentElement.offsetHeight-100&&u&&!c&&C()};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[u,c]);const $=e=>{S(e),p(!0)},I=()=>{v&&L.delete(`/todos/${v.id}`).then(()=>{b("deleted successfully"),h([]),j(1),w(!0),C()}).catch(e=>{console.log(e),b("Error deleting todo",e)}),p(!1),S(null)},o=U(),P=l.useMemo(()=>[o.accessor("today_date",{header:"Date",cell:e=>e.getValue()}),o.accessor("category",{header:"Category",cell:e=>e.getValue().toUpperCase()}),o.accessor("title",{header:"Title",cell:e=>e.getValue()}),o.accessor("topic",{header:"Topic",cell:e=>e.getValue()}),o.accessor("description",{header:"Description",cell:e=>e.getValue()?e.getValue().length>25?`${e.getValue().substring(0,25)}...`:e.getValue():" "}),o.display({id:"actions",header:"Actions",cell:({row:e})=>t.jsxs(t.Fragment,{children:[t.jsx(Q,{to:`/science/${e.original.id}`,className:"text-blue-500 hover:underline",children:"Show"}),["owner","science-d"].some(s=>a.role.includes(s))&&t.jsx(D,{className:"ml-4 bg-red-500 text-white hover:bg-red-600",onClick:()=>$(e.original),children:"Delete"})]})})],[a]),T=l.useMemo(()=>d.filter(e=>{var s,m,x;return(((s=e.title)==null?void 0:s.toLowerCase())||"").includes(n.toLowerCase())||(((m=e.topic)==null?void 0:m.toLowerCase())||"").includes(n.toLowerCase())||(((x=e.description)==null?void 0:x.toLowerCase())||"").includes(n.toLowerCase())}),[d,n]),N=F({data:T,columns:P,getCoreRowModel:q(),getSortedRowModel:z()});return t.jsxs("div",{className:"p-4 mx-auto",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4",children:[t.jsx("h1",{className:"text-2xl font-semibold cursor-pointer",onClick:()=>y(""),children:"Data Science Lecturers"}),t.jsxs("h3",{children:["Total : ",A]}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center w-full sm:w-auto sm:space-x-4",children:[t.jsx("div",{className:"w-full sm:w-1/2 mb-4 sm:mb-0 sm:order-1 mr-6",children:t.jsxs(G,{value:r,onValueChange:e=>{M(e),h([]),j(1),w(!0)},className:"mt-1 block w-full",children:[t.jsx(J,{className:"xl:w-[150px]",children:t.jsx("span",{children:r||"---select---"})}),t.jsxs(K,{children:[t.jsx(i,{value:"all",children:"All"}),t.jsx(i,{value:"lecturer",children:"Lecturer"}),t.jsx(i,{value:"public_holidays",children:"Public Holidays"}),t.jsx(i,{value:"no_lecturer",children:"No Lecturer"}),t.jsx(i,{value:"time_e",children:"Time E"})]})]})}),t.jsx(le,{type:"text",placeholder:"Search",value:n,onChange:e=>y(e.target.value),className:"py-2 px-4 rounded-md focus:outline-none focus:ring-2 sm:order-2 xl:w-[200px]"}),["owner","science-c"].some(e=>a.role.includes(e))&&t.jsx(D,{className:"bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 sm:order-2 xl:w-[100px]",onClick:()=>g("/science/new"),children:"Create"})]})]}),t.jsxs("div",{className:"mt-8",children:[t.jsxs(W,{className:"overflow-x-auto",children:[c&&d.length===0?t.jsx("div",{className:"flex items-center justify-center p-4",children:t.jsx(H,{})}):T.length>0?t.jsxs(X,{children:[t.jsx(Y,{children:N.getHeaderGroups().map(e=>t.jsx(V,{children:e.headers.map(s=>t.jsx(Z,{className:"cursor-pointer",children:s.isPlaceholder?null:t.jsxs("div",{onClick:s.column.getToggleSortingHandler(),children:[E(s.column.columnDef.header,s.getContext()),{asc:" ðŸ”¼ ",desc:" ðŸ”½ "}[s.column.getIsSorted()]??null]})},s.id))},e.id))}),t.jsx(ee,{children:N.getRowModel().rows.map(e=>t.jsx(V,{children:e.getVisibleCells().map(s=>t.jsx(te,{children:E(s.column.columnDef.cell,s.getContext())},s.id))},e.id))})]}):t.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"No todos found."}),c&&u&&d.length!=0&&t.jsx("div",{className:"flex items-center justify-center p-4",children:t.jsx(H,{})})]}),t.jsx(se,{open:R,onClose:()=>p(!1),onConfirm:I,title:"Confirm Deletion",description:"Are you sure you want to delete this todo? This action cannot be undone."})]})]})}export{xe as default};
