import{u as A,b as M,r as t,j as s,L as m,a as v}from"./index-D2TPxXiu.js";import{u as E,f as y,c as H,g as I,a as B}from"./index-uVGQkMVq.js";import"./select-B3KVTSd3.js";import{B as S}from"./button-GmKsRPRy.js";import{C as F}from"./card-DQXNvk-Z.js";import{L as O}from"./Loader-2ymP49Ji.js";import{T as Q,a as J,b as T,c as P,d as _,e as q}from"./table-0Os8YReR.js";import{A as z}from"./AlertDialogDemo-CcE40q5i.js";import{I as G}from"./input-D2H9KHWJ.js";function le(){const{user:l,setNotification:x}=A(),c=M(),[h,R]=t.useState([]),[i,K]=t.useState("all"),[D,d]=t.useState(!1),[g,f]=t.useState(null),[L,u]=t.useState(!1),[n,p]=t.useState("");t.useEffect(()=>{["owner","row"].some(o=>l.role.includes(o))||c("/404")},[l,c]);const w=()=>{d(!0),v.get(`/rows${i!=="all"?`?category=${i}`:""}`).then(o=>{R(o.data),d(!1)}).catch(o=>{console.error("Error fetching todos",o),d(!1)})};t.useEffect(()=>{w()},[i]);const j=o=>{f(o),u(!0)},V=()=>{g&&v.delete(`/row/${g.id}`).then(()=>{x("row was successfully deleted"),w()}).catch(o=>{console.log(o),x("Error deleting todo",o)}),u(!1),f(null)},a=H(),k=t.useMemo(()=>{const o=[a.accessor("title",{header:"Title",cell:e=>e.getValue()}),a.accessor("description",{header:"Description",cell:e=>e.getValue()?e.getValue().length>25?`${e.getValue().substring(0,25)}...`:e.getValue():" "}),a.accessor("files",{header:"Files",cell:e=>{const r=JSON.parse(e.getValue()||"[]");return r.length>0?r.map(($,N)=>s.jsxs(m,{to:`https://my.thedhruvish.com/api/storage/${$}`,className:"text-blue-500 hover:underline",target:"_blank",children:["View File ",N+1]},N)):"No files"}}),a.display({id:"actions",header:"Actions",cell:({row:e})=>l.role==="owner"||l.role==="admin"?s.jsxs(s.Fragment,{children:[s.jsx(m,{to:`/row/${e.original.id}`,className:"text-blue-500 hover:underline",children:"Show"}),["owner","row-d"].some(r=>l.role.includes(r))&&s.jsx(S,{className:"ml-4 hover:bg-red-600",onClick:()=>j(e.original),children:"Delete"})]}):s.jsx(m,{to:`/row/${e.original.id}`,className:"text-blue-500 hover:underline",children:"Show"})})];return(l.role==="owner"||l.role==="admin")&&o.push(a.accessor("author",{header:"Author",cell:e=>e.getValue()})),o},[l,j]),C=t.useMemo(()=>(h||[]).filter(o=>{var e,r;return(((e=o.title)==null?void 0:e.toLowerCase())||"").includes(n.toLowerCase())||(((r=o.description)==null?void 0:r.toLowerCase())||"").includes(n.toLowerCase())}),[h,n]),b=E({data:C,columns:k,getCoreRowModel:I(),getSortedRowModel:B()});return s.jsxs("div",{className:"p-4 mx-auto",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4",children:[s.jsx("h1",{className:"text-2xl font-semibold cursor-pointer",onClick:()=>p(""),children:"Row Items"}),s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center w-full sm:w-auto sm:space-x-4",children:[s.jsx(G,{type:"text",placeholder:"Search",value:n,onChange:o=>p(o.target.value),className:"py-2 px-4 rounded-md focus:outline-none focus:ring-2 sm:order-2 xl:w-[200px]"}),s.jsx(S,{className:"bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 sm:order-2 xl:w-[100px]",onClick:()=>c("/row/new"),children:"Create"})]})]}),s.jsxs("div",{className:"mt-8",children:[s.jsx(F,{className:"overflow-x-auto",children:D?s.jsx("div",{className:"flex items-center justify-center p-4",children:s.jsx(O,{})}):C.length>0?s.jsxs(Q,{children:[s.jsx(J,{children:b.getHeaderGroups().map(o=>s.jsx(T,{children:o.headers.map(e=>s.jsx(P,{className:"cursor-pointer",children:e.isPlaceholder?null:s.jsxs("div",{onClick:e.column.getToggleSortingHandler(),children:[y(e.column.columnDef.header,e.getContext()),{asc:" ðŸ”¼ ",desc:" ðŸ”½ "}[e.column.getIsSorted()]??null]})},e.id))},o.id))}),s.jsx(_,{children:b.getRowModel().rows.map(o=>s.jsx(T,{children:o.getVisibleCells().map(e=>s.jsx(q,{children:y(e.column.columnDef.cell,e.getContext())},e.id))},o.id))})]}):s.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"No rows found."})}),s.jsx(z,{open:L,onClose:()=>u(!1),onConfirm:V,title:"Confirm Deletion",description:"Are you sure you want to delete this todo? This action cannot be undone."})]})]})}export{le as default};
