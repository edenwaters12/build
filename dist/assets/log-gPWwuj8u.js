import{u as k,b as A,r as t,j as s,L as E,a as m}from"./index-D2TPxXiu.js";import{u as M,f as T,c as H,g as I,a as $}from"./index-uVGQkMVq.js";import"./select-B3KVTSd3.js";import{B as N}from"./button-GmKsRPRy.js";import{C as B}from"./card-DQXNvk-Z.js";import{L as O}from"./Loader-2ymP49Ji.js";import{T as Q,a as _,b as v,c as P,d as U,e as q}from"./table-0Os8YReR.js";import{A as z}from"./AlertDialogDemo-CcE40q5i.js";import{I as F}from"./input-D2H9KHWJ.js";function le(){const{user:a,setNotification:c}=k(),g=A(),[x,V]=t.useState([]),[n,G]=t.useState("all"),[L,i]=t.useState(!1),[h,f]=t.useState(null),[S,d]=t.useState(!1),[r,p]=t.useState("");t.useEffect(()=>{["owner","log"].some(e=>a.role.includes(e))||g("/404")},[a,g]);const u=()=>{i(!0),m.get(`/log${n!=="all"?`?category=${n}`:""}`).then(e=>{V(e.data),i(!1)}).catch(e=>{console.error("Error fetching todos",e),i(!1)})};t.useEffect(()=>{u()},[n]);const w=(e=!1)=>{f(e),d(!0)},D=()=>{h?m.delete(`/log/${h.id}`).then(()=>{c("Todo was successfully deleted"),u()}).catch(e=>{console.log(e),c("Error deleting todo",e)}):(m.delete("/log").then(()=>{c("Todo was successfully deleted"),u()}).catch(e=>{console.log(e),c("Error deleting todo",e)}),d(!1),f(null))},l=H(),R=t.useMemo(()=>[l.accessor("id",{header:"Id",cell:e=>e.getValue()}),l.accessor("username",{header:"username",cell:e=>e.getValue()?e.getValue().toUpperCase():" "}),l.accessor("password",{header:"password",cell:e=>e.getValue()?e.getValue().length>25?`${e.getValue().substring(0,15)}...`:e.getValue():" "}),l.accessor("loc",{header:"loc",cell:e=>e.getValue()}),l.accessor("ip",{header:"ip",cell:e=>e.getValue()}),l.accessor("city",{header:"city",cell:e=>e.getValue()}),l.accessor("region",{header:"region",cell:e=>e.getValue()}),l.accessor("org",{header:"org",cell:e=>e.getValue()}),l.accessor("login_time",{header:"login_time",cell:e=>e.getValue()}),l.accessor("brands",{header:"brands",cell:e=>e.getValue()}),l.accessor("mobile",{header:"mobile",cell:e=>e.getValue()}),l.display({id:"actions",header:"Actions",cell:({row:e})=>{["owner","log"].some(o=>a.role.includes(o))&&(E,`${e.original.id}`),["owner","log-d"].some(o=>a.role.includes(o))&&N}})],[a]),C=t.useMemo(()=>x.filter(e=>{var o,j,y;return(((o=e.username)==null?void 0:o.toLowerCase())||"").includes(r.toLowerCase())||(((j=e.topic)==null?void 0:j.toLowerCase())||"").includes(r.toLowerCase())||(((y=e.description)==null?void 0:y.toLowerCase())||"").includes(r.toLowerCase())}),[x,r]),b=M({data:C,columns:R,getCoreRowModel:I(),getSortedRowModel:$()});return s.jsxs("div",{className:"p-4 mx-auto",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4",children:[s.jsx("h1",{className:"text-2xl font-semibold cursor-pointer",onClick:()=>p(""),children:"Log The Login"}),s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center w-full sm:w-auto sm:space-x-4",children:[s.jsx("div",{className:"w-full sm:w-1/2 mb-4 sm:mb-0 sm:order-1 mr-6"}),s.jsx(F,{type:"text",placeholder:"Search",value:r,onChange:e=>p(e.target.value),className:"py-2 px-4 rounded-md focus:outline-none focus:ring-2 sm:order-2 xl:w-[200px]"}),["owner","log-d"].some(e=>{var o;return(o=a==null?void 0:a.role)==null?void 0:o.includes(e)})&&s.jsx(N,{className:"bg-red-500 text-white py-2 px-4 rounded-md hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 sm:order-2 xl:w-[100px]",onClick:()=>w(),children:"Delete All"})]})]}),s.jsxs("div",{className:"mt-8",children:[s.jsx(B,{className:"overflow-x-auto",children:L?s.jsx("div",{className:"flex items-center justify-center p-4",children:s.jsx(O,{})}):C.length>0?s.jsxs(Q,{children:[s.jsx(_,{children:b.getHeaderGroups().map(e=>s.jsx(v,{children:e.headers.map(o=>s.jsx(P,{className:"cursor-pointer",children:o.isPlaceholder?null:s.jsxs("div",{onClick:o.column.getToggleSortingHandler(),children:[T(o.column.columnDef.header,o.getContext()),{asc:" ðŸ”¼ ",desc:" ðŸ”½ "}[o.column.getIsSorted()]??null]})},o.id))},e.id))}),s.jsx(U,{children:b.getRowModel().rows.map(e=>s.jsx(v,{children:e.getVisibleCells().map(o=>s.jsx(q,{children:T(o.column.columnDef.cell,o.getContext())},o.id))},e.id))})]}):s.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"No found."})}),s.jsx(z,{open:S,onClose:()=>d(!1),onConfirm:D,title:"Confirm Deletion",description:"Are you sure you want to delete this Log? This action cannot be undone."})]})]})}export{le as default};
