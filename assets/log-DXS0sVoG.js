import{u as k,b as D,r as t,j as s,L as A,a as m}from"./index-CrO11q5U.js";import{P as E,T as M,u as H,f as N,c as I,g as B,a as P}from"./index-DJGYMKwb.js";import{B as g}from"./button-CuqhUsHb.js";import{C as $}from"./card-DIOXgyU6.js";import{L as O}from"./Loader-Kd97LW-S.js";import{T as Q,a as _,b as v,c as U,d as q,e as z}from"./table-B6Cle3ST.js";import{A as F}from"./AlertDialogDemo-CM6L2AzR.js";import{I as G}from"./input-B9ud5Mvz.js";function oe(){const{user:a,setNotification:c}=k(),x=D(),[h,y]=t.useState([]),[V,n]=t.useState(!1),[f,p]=t.useState(null),[L,i]=t.useState(!1),[r,j]=t.useState("");t.useEffect(()=>{["owner","log"].some(e=>a.role.includes(e))||x("/404")},[a,x]);const d=()=>{n(!0),m.get("/log").then(e=>{y(e.data),n(!1)}).catch(e=>{console.error("Error fetching todos",e),n(!1)})};t.useEffect(()=>{d()},[]);const u=(e=!1)=>{p(e),i(!0)},S=()=>{f?m.delete(`/log/${f.id}`).then(()=>{c("Todo was successfully deleted"),d()}).catch(e=>{c("Error deleting todo",e)}):(m.delete("/log").then(()=>{c("Todo was successfully deleted"),d()}).catch(e=>{c("Error deleting todo",e)}),i(!1),p(null))},l=I(),R=t.useMemo(()=>[l.accessor("id",{header:"Id",cell:e=>e.getValue()}),l.accessor("username",{header:"username",cell:e=>e.getValue()?e.getValue().toUpperCase():" "}),l.accessor("password",{header:"password",cell:e=>e.getValue()?e.getValue().length>25?`${e.getValue().substring(0,15)}...`:e.getValue():" "}),l.accessor("loc",{header:"loc",cell:e=>e.getValue()}),l.accessor("ip",{header:"ip",cell:e=>e.getValue()}),l.accessor("city",{header:"city",cell:e=>e.getValue()}),l.accessor("region",{header:"region",cell:e=>e.getValue()}),l.accessor("org",{header:"org",cell:e=>e.getValue()}),l.accessor("login_time",{header:"login_time",cell:e=>e.getValue()}),l.accessor("brands",{header:"brands",cell:e=>e.getValue()}),l.accessor("mobile",{header:"mobile",cell:e=>e.getValue()}),l.display({id:"actions",header:"Actions",cell:({row:e})=>{["owner","log"].some(o=>a.role.includes(o))&&(A,`${e.original.id}`,g,E),["owner","log-d"].some(o=>a.role.includes(o))&&(g,M)}})],[l,a.role]),w=t.useMemo(()=>h.filter(e=>{var o,b,T;return(((o=e.username)==null?void 0:o.toLowerCase())||"").includes(r.toLowerCase())||(((b=e.topic)==null?void 0:b.toLowerCase())||"").includes(r.toLowerCase())||(((T=e.description)==null?void 0:T.toLowerCase())||"").includes(r.toLowerCase())}),[h,r]),C=H({data:w,columns:R,getCoreRowModel:B(),getSortedRowModel:P()});return s.jsxs("div",{className:"p-4 mx-auto",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4",children:[s.jsx("h1",{className:"text-2xl font-semibold cursor-pointer",onClick:()=>j(""),children:"Log The Login"}),s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center w-full sm:w-auto sm:space-x-4",children:[s.jsx("div",{className:"w-full sm:w-1/2 mb-4 sm:mb-0 sm:order-1 mr-6"}),s.jsx(G,{type:"text",placeholder:"Search",value:r,onChange:e=>j(e.target.value),className:"py-2 px-4 rounded-md focus:outline-none focus:ring-2 sm:order-2 xl:w-[200px]"}),["owner","log-d"].some(e=>{var o;return(o=a==null?void 0:a.role)==null?void 0:o.includes(e)})&&s.jsx(g,{className:" py-2 px-4 rounded-md hover:bg-red-400 focus:outline-none focus:ring-2 focus:ring-red-500 sm:order-2 xl:w-[100px]",onClick:()=>u(),children:"Delete All"})]})]}),s.jsxs("div",{className:"mt-8",children:[s.jsx($,{className:"overflow-x-auto",children:V?s.jsx("div",{className:"flex items-center justify-center p-4",children:s.jsx(O,{})}):w.length>0?s.jsxs(Q,{children:[s.jsx(_,{children:C.getHeaderGroups().map(e=>s.jsx(v,{children:e.headers.map(o=>s.jsx(U,{className:"cursor-pointer",children:o.isPlaceholder?null:s.jsxs("div",{onClick:o.column.getToggleSortingHandler(),children:[N(o.column.columnDef.header,o.getContext()),{asc:" ðŸ”¼ ",desc:" ðŸ”½ "}[o.column.getIsSorted()]??null]})},o.id))},e.id))}),s.jsx(q,{children:C.getRowModel().rows.map(e=>s.jsx(v,{children:e.getVisibleCells().map(o=>s.jsx(z,{children:N(o.column.columnDef.cell,o.getContext())},o.id))},e.id))})]}):s.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"No found."})}),s.jsx(F,{open:L,onClose:()=>i(!1),onConfirm:S,title:"Confirm Deletion",description:"Are you sure you want to delete this Log? This action cannot be undone."})]})]})}export{oe as default};
