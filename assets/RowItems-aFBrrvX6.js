import{u as A,b as M,r as t,j as s,L as u,a as C}from"./index-Bg1UFyfG.js";import{u as E,f as N,c as H,g as I,a as $}from"./index-BW0SkIZ8.js";import{B as v}from"./button-CSgnsCXw.js";import{C as B}from"./card-D2IRlOIe.js";import{L as F}from"./Loader-CK4VFoln.js";import{T as O,a as Q,b as S,c as J,d as P,e as _}from"./table-DwRk9wtw.js";import{A as q}from"./AlertDialogDemo-CAPwVT8t.js";import{I as z}from"./input-Dq0MWHsb.js";function se(){const{user:l,setNotification:m}=A(),c=M(),[x,T]=t.useState([]),[y,i]=t.useState(!1),[h,f]=t.useState(null),[R,d]=t.useState(!1),[n,g]=t.useState("");t.useEffect(()=>{["owner","row"].some(o=>l.role.includes(o))||c("/404")},[l,c]);const p=()=>{i(!0),C.get("/rows").then(o=>{T(o.data),i(!1)}).catch(o=>{console.error("Error fetching todos",o),i(!1)})};t.useEffect(()=>{p()},[]);const D=o=>{f(o),d(!0)},L=()=>{h&&C.delete(`/row/${h.id}`).then(()=>{m("row was successfully deleted"),p()}).catch(o=>{m("Error deleting todo",o)}),d(!1),f(null)},a=H(),V=t.useMemo(()=>{const o=[a.accessor("title",{header:"Title",cell:e=>e.getValue()}),a.accessor("description",{header:"Description",cell:e=>e.getValue()?e.getValue().length>25?`${e.getValue().substring(0,25)}...`:e.getValue():" "}),a.accessor("files",{header:"Files",cell:e=>{const r=JSON.parse(e.getValue()||"[]");return r.length>0?r.map((k,b)=>s.jsxs(u,{to:`https://my.thedhruvish.com/api/storage/${k}`,className:"text-blue-500 hover:underline",target:"_blank",children:["View File ",b+1]},b)):"No files"}}),a.display({id:"actions",header:"Actions",cell:({row:e})=>l.role==="owner"||l.role==="admin"?s.jsxs(s.Fragment,{children:[s.jsx(u,{to:`/row/${e.original.id}`,className:"text-blue-500 hover:underline",children:"Show"}),["owner","row-d"].some(r=>l.role.includes(r))&&s.jsx(v,{className:"ml-4 hover:bg-red-600",onClick:()=>D(e.original),children:"Delete"})]}):s.jsx(u,{to:`/row/${e.original.id}`,className:"text-blue-500 hover:underline",children:"Show"})})];return(l.role==="owner"||l.role==="admin")&&o.push(a.accessor("author",{header:"Author",cell:e=>e.getValue()})),o},[a,l.role]),w=t.useMemo(()=>(x||[]).filter(o=>{var e,r;return(((e=o.title)==null?void 0:e.toLowerCase())||"").includes(n.toLowerCase())||(((r=o.description)==null?void 0:r.toLowerCase())||"").includes(n.toLowerCase())}),[x,n]),j=E({data:w,columns:V,getCoreRowModel:I(),getSortedRowModel:$()});return s.jsxs("div",{className:"p-4 mx-auto",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4",children:[s.jsx("h1",{className:"text-2xl font-semibold cursor-pointer",onClick:()=>g(""),children:"Row Items"}),s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center w-full sm:w-auto sm:space-x-4",children:[s.jsx(z,{type:"text",placeholder:"Search",value:n,onChange:o=>g(o.target.value),className:"py-2 px-4 rounded-md focus:outline-none focus:ring-2 sm:order-2 xl:w-[200px]"}),s.jsx(v,{className:"bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 sm:order-2 xl:w-[100px]",onClick:()=>c("/row/new"),children:"Create"})]})]}),s.jsxs("div",{className:"mt-8",children:[s.jsx(B,{className:"overflow-x-auto",children:y?s.jsx("div",{className:"flex items-center justify-center p-4",children:s.jsx(F,{})}):w.length>0?s.jsxs(O,{children:[s.jsx(Q,{children:j.getHeaderGroups().map(o=>s.jsx(S,{children:o.headers.map(e=>s.jsx(J,{className:"cursor-pointer",children:e.isPlaceholder?null:s.jsxs("div",{onClick:e.column.getToggleSortingHandler(),children:[N(e.column.columnDef.header,e.getContext()),{asc:" ðŸ”¼ ",desc:" ðŸ”½ "}[e.column.getIsSorted()]??null]})},e.id))},o.id))}),s.jsx(P,{children:j.getRowModel().rows.map(o=>s.jsx(S,{children:o.getVisibleCells().map(e=>s.jsx(_,{children:N(e.column.columnDef.cell,e.getContext())},e.id))},o.id))})]}):s.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"No rows found."})}),s.jsx(q,{open:R,onClose:()=>d(!1),onConfirm:L,title:"Confirm Deletion",description:"Are you sure you want to delete this todo? This action cannot be undone."})]})]})}export{se as default};
