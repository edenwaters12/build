import{u as C,c as S,r as m,d as M,j as e,C as A,b as $,t as F,I as o,s as E,B as G,A as U,a as x}from"./index-C80r3nWj.js";import{S as p,a as j,b as f,c as b}from"./select-Xjabn7IN.js";function W(){const{user:i,setNotification:c}=C(),n=S();m.useEffect(()=>{i.role==="owner"||i.role==="admin"||n("/404")});const{id:r}=M(),[s,l]=m.useState({title:"",money:"",description:"",dateTime:g(),whoToTake:"",ToGivemoney:"",toDaydate:g(),toTakeDate:g(),category:"deposite",moneyType:"cash"}),[d,k]=m.useState({}),[u,y]=m.useState(!1),[N,T]=m.useState(!1),v=["deposite","withdraw","remaining"],w=["cash","online"];m.useEffect(()=>{r&&(async()=>{y(!0);try{const t=await x.get(`/money-management/${r}`);l(t.data)}catch(t){c(t.message),T(!0)}finally{y(!1)}})()},[r,c]);const D=async a=>{a.preventDefault(),y(!0);try{r?(await x.put(`/money-management/${r}`,s),c("Data was successfully updated")):(await x.post("/money-management",s),c("Data was successfully saved")),n("/money-management")}catch(t){y(!1);const h=t.response;h&&h.status===422&&(k(h.data.errors),c("Failed to save data"))}};return e.jsxs("div",{className:"flex flex-col items-center min-h-screen p-4 bg-gray-100 dark:bg-gray-900",children:[e.jsxs(A,{className:"w-full max-w-md p-8 bg-white dark:bg-gray-800 text-black dark:text-white",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-6 text-center",children:r?`Edit ${s.category.charAt(0).toUpperCase()+s.category.slice(1)}`:`New ${s.category.charAt(0).toUpperCase()+s.category.slice(1)} Entry`}),u&&e.jsx($,{}),d&&Object.keys(d).length>0&&e.jsx(F,{variant:"error",className:"mb-4",children:Object.keys(d).map(a=>e.jsx("p",{children:d[a][0]},a))}),!u&&e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium dark:text-gray-200",children:"Money Type"}),e.jsxs(p,{value:s.category,onValueChange:a=>l(t=>({...t,category:a})),className:"mt-1 block w-full",children:[e.jsx(j,{children:e.jsx("span",{children:s.category.charAt(0).toUpperCase()+s.category.slice(1)})}),e.jsx(f,{children:v.map(a=>e.jsx(b,{value:a,children:a.charAt(0).toUpperCase()+a.slice(1)},a))})]})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:"Title"}),e.jsx(o,{type:"text",value:s.title,onChange:a=>l(t=>({...t,title:a.target.value})),placeholder:"Title",required:!0,className:"w-full mt-1"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:"Description"}),e.jsx(E,{value:s.description,onChange:a=>l(t=>({...t,description:a.target.value})),placeholder:"Description",rows:"4",className:"w-full p-2 border mt-1"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium dark:text-gray-200",children:"Money Type"}),e.jsxs(p,{value:s.moneyType,onValueChange:a=>l(t=>({...t,moneyType:a})),className:"mt-1 block w-full",children:[e.jsx(j,{children:e.jsx("span",{children:s.moneyType||"---select---"})}),e.jsx(f,{children:w.map(a=>e.jsx(b,{value:a,children:a.charAt(0).toUpperCase()+a.slice(1)},a))})]})]}),s.category==="deposite"&&e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:"Total Money"}),e.jsx(o,{type:"number",value:s.money,onChange:a=>l(t=>({...t,money:a.target.value})),placeholder:"Total Money",required:!0,className:"w-full mt-1"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:"Who to Take"}),e.jsx(o,{type:"text",value:s.whoToTake,onChange:a=>l(t=>({...t,whoToTake:a.target.value})),placeholder:"Who to Take",className:"w-full mt-1"})]})]}),s.category==="withdraw"&&e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:"Money"}),e.jsx(o,{type:"number",value:s.money,onChange:a=>l(t=>({...t,money:a.target.value})),placeholder:"Money",required:!0,className:"w-full mt-1"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:"To Give Money"}),e.jsx(o,{type:"text",value:s.ToGivemoney,onChange:a=>l(t=>({...t,ToGivemoney:a.target.value})),placeholder:"To Give Money",className:"w-full mt-1"})]})]}),s.category==="remaining"&&e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:"Money"}),e.jsx(o,{type:"number",value:s.money,onChange:a=>l(t=>({...t,money:a.target.value})),placeholder:"Money",required:!0,className:"w-full mt-1"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:"Who to Take"}),e.jsx(o,{type:"text",value:s.whoToTake,onChange:a=>l(t=>({...t,whoToTake:a.target.value})),placeholder:"Who to Take",className:"w-full mt-1"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:"To Take Date"}),e.jsx(o,{type:"date",value:s.toTakeDate,onChange:a=>l(t=>({...t,toTakeDate:a.target.value})),placeholder:"To Take Date",className:"w-full mt-1"})]})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:"Today Date"}),e.jsx(o,{type:"date",value:s.toDaydate,onChange:a=>l(t=>({...t,toDaydate:a.target.value})),placeholder:"To Give Date",className:"w-full mt-1"})]}),e.jsx(G,{type:"submit",className:"mt-4",children:r?"Update":"Submit"})]})]}),e.jsx(U,{open:N,onClose:()=>n("/money"),onConfirm:()=>window.location.reload(),description:"Failed to fetch data. Please try again or go to the home page."})]})}function g(){const i=new Date,c=i.getFullYear();let n=i.getMonth()+1,r=i.getDate();return r<10&&(r=`0${r}`),n<10&&(n=`0${n}`),`${c}-${n}-${r}`}export{W as default};
