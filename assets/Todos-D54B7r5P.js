import{u as B,c as O,r as l,j as s,L as Q,B as b,T as F,e as U,I as q,C as z,b as k,f as G,g as J,h as D,i as K,k as H,l as W,m as X,A as Y,a as V,n as Z,o as ee,p as se}from"./index-C80r3nWj.js";import{S as te,a as le,b as ae,c as i}from"./select-Xjabn7IN.js";import{P as oe}from"./pen-r_-_yYU3.js";function ie(){const{user:o,setNotification:v}=B(),g=O(),[d,h]=l.useState([]),[c,M]=l.useState("all"),[r,f]=l.useState(!1),[y,S]=l.useState(null),[R,p]=l.useState(!1),[n,N]=l.useState(""),[A,j]=l.useState(1),[P,_]=l.useState(),[u,w]=l.useState(!0);l.useEffect(()=>{["owner","science"].some(e=>o.role.includes(e))||g("/404")},[o,g]);const C=()=>{!u||r||(f(!0),V.get(`/todos?page=${A}${c!=="all"?`&category=${c}`:""}`).then(e=>{h(t=>[...t,...e.data.data.filter(m=>!t.some(x=>x.id===m.id))]),_(e.data.total),e.data.current_page==e.data.last_page&&w(!1),j(t=>t+1),f(!1)}).catch(e=>{console.error("Error fetching todos",e),f(!1)}))};l.useEffect(()=>{C()},[c]),l.useEffect(()=>{const e=()=>{window.innerHeight+document.documentElement.scrollTop>=document.documentElement.offsetHeight-100&&u&&!r&&C()};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[u,r]);const T=e=>{S(e),p(!0)},$=()=>{y&&V.delete(`/todos/${y.id}`).then(()=>{v("deleted successfully"),h([]),j(1),w(!0),C()}).catch(e=>{v("Error deleting todo",e)}),p(!1),S(null)},a=Z(),I=l.useMemo(()=>[a.accessor("today_date",{header:"Date",cell:e=>e.getValue()}),a.accessor("category",{header:"Category",cell:e=>e.getValue().toUpperCase()}),a.accessor("title",{header:"Title",cell:e=>e.getValue()}),a.accessor("topic",{header:"Topic",cell:e=>e.getValue()}),a.accessor("description",{header:"Description",cell:e=>e.getValue()?e.getValue().length>25?`${e.getValue().substring(0,25)}...`:e.getValue():" "}),a.display({id:"actions",header:"Actions",cell:({row:e})=>s.jsx(s.Fragment,{children:s.jsxs("div",{className:"flex flex-wrap gap-2 items-center justify-around",children:[s.jsx(Q,{to:`/science/${e.original.id}`,className:"text-blue-500 hover:underline",children:s.jsx(b,{className:"ml-4 hover:bg-blue-600",onClick:()=>T(e.original),children:s.jsx(oe,{})})}),["owner","science-d"].some(t=>o.role.includes(t))&&s.jsx(b,{className:"ml-4  hover:bg-red-600",onClick:()=>T(e.original),children:s.jsx(F,{})})]})})})],[o]),L=l.useMemo(()=>d.filter(e=>{var t,m,x;return(((t=e.title)==null?void 0:t.toLowerCase())||"").includes(n.toLowerCase())||(((m=e.topic)==null?void 0:m.toLowerCase())||"").includes(n.toLowerCase())||(((x=e.description)==null?void 0:x.toLowerCase())||"").includes(n.toLowerCase())}),[d,n]),E=U({data:L,columns:I,getCoreRowModel:ee(),getSortedRowModel:se()});return s.jsxs("div",{className:"p-4 mx-auto",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4",children:[s.jsx("h1",{className:"text-2xl font-semibold cursor-pointer",onClick:()=>N(""),children:"Data Science Lecturers"}),s.jsxs("h3",{children:["Total : ",P]}),s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center w-full sm:w-auto sm:space-x-4",children:[s.jsx("div",{className:"w-full sm:w-1/2 mb-4 sm:mb-0 sm:order-1 mr-6",children:s.jsxs(te,{value:c,onValueChange:e=>{M(e),h([]),j(1),w(!0)},className:"mt-1 block w-full",children:[s.jsx(le,{className:"xl:w-[150px]",children:s.jsx("span",{children:c||"---select---"})}),s.jsxs(ae,{children:[s.jsx(i,{value:"all",children:"All"}),s.jsx(i,{value:"lecturer",children:"Lecturer"}),s.jsx(i,{value:"public_holidays",children:"Public Holidays"}),s.jsx(i,{value:"no_lecturer",children:"No Lecturer"}),s.jsx(i,{value:"time_e",children:"Time E"})]})]})}),s.jsx(q,{type:"text",placeholder:"Search",value:n,onChange:e=>N(e.target.value),className:"py-2 px-4 rounded-md focus:outline-none focus:ring-2 sm:order-2 xl:w-[200px]"}),["owner","science-c"].some(e=>o.role.includes(e))&&s.jsx(b,{className:"bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 sm:order-2 xl:w-[100px]",onClick:()=>g("/science/new"),children:"Create"})]})]}),s.jsxs("div",{className:"mt-8",children:[s.jsxs(z,{className:"overflow-x-auto",children:[r&&d.length===0?s.jsx("div",{className:"flex items-center justify-center p-4",children:s.jsx(k,{})}):L.length>0?s.jsxs(G,{children:[s.jsx(J,{children:E.getHeaderGroups().map(e=>s.jsx(D,{children:e.headers.map(t=>s.jsx(K,{className:"cursor-pointer",children:t.isPlaceholder?null:s.jsxs("div",{onClick:t.column.getToggleSortingHandler(),children:[H(t.column.columnDef.header,t.getContext()),{asc:" ðŸ”¼ ",desc:" ðŸ”½ "}[t.column.getIsSorted()]??null]})},t.id))},e.id))}),s.jsx(W,{children:E.getRowModel().rows.map(e=>s.jsx(D,{children:e.getVisibleCells().map(t=>s.jsx(X,{children:H(t.column.columnDef.cell,t.getContext())},t.id))},e.id))})]}):s.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"No todos found."}),r&&u&&d.length!=0&&s.jsx("div",{className:"flex items-center justify-center p-4",children:s.jsx(k,{})})]}),s.jsx(Y,{open:R,onClose:()=>p(!1),onConfirm:$,title:"Confirm Deletion",description:"Are you sure you want to delete this todo? This action cannot be undone."})]})]})}export{ie as default};
